var b=Object.defineProperty;var k=(d,e,t)=>e in d?b(d,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[e]=t;var o=(d,e,t)=>k(d,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();const f={blockHeight:{coords:30,pixels:100}},y=[{id:"one",name:"One",colour:"#55be53"},{id:"two",name:"Two",colour:"#ffdd40"},{id:"secret",name:"The Secret",colour:"#82def9"},{id:"floor",name:"The Floor",colour:"#6058ad"},{id:"casbah",name:"The Casbah",colour:"#ff3a35"},{id:"coney-island",name:"Coney Island",colour:"#2a5bb0"},{id:"muziekgieterij",name:"Muziekgieterij",colour:"#a8381b"},{id:"playground-love",name:"Playground Love",colour:"#ff5626"},{id:"lodge",name:"The Lodge",colour:"#f0b573"},{id:"wilder-wanderland",name:"Wilder Wanderland",colour:"#1e6936"}],S=JSON.parse(`[{"id":"friday","name":"Friday","date":"2024-06-07","events":{"one":[{"start":"16:30","end":"17:15","name":"St. Paul & The Broken Bones","url":"https://www.bestkeptsecret.nl/program/st-paul-the-broken-bones/49844"},{"start":"18:15","end":"19:15","name":"La Femme","url":"https://www.bestkeptsecret.nl/program/la-femme/49805"},{"start":"20:15","end":"21:15","name":"Viagra Boys","url":"https://www.bestkeptsecret.nl/program/viagra-boys/49911"},{"start":"22:30","end":"00:00","name":"Disclosure","url":"https://www.bestkeptsecret.nl/program/disclosure/49769"}],"two":[{"start":"14:30","end":"15:15","name":"Alice Phoebe Lou","url":"https://www.bestkeptsecret.nl/program/alice-phoebe-lou/51376"},{"start":"15:45","end":"16:30","name":"Libianca","url":"https://www.bestkeptsecret.nl/program/libianca/49808"},{"start":"17:15","end":"18:15","name":"Badbadnotgood","url":"https://www.bestkeptsecret.nl/program/badbadnotgood/49765"},{"start":"19:15","end":"20:15","name":"Omar Apollo","url":"https://www.bestkeptsecret.nl/program/omar-apollo/51422"},{"start":"21:15","end":"22:15","name":"St. Vincent","url":"https://www.bestkeptsecret.nl/program/st-vincent/51443"},{"start":"00:00","end":"01:00","name":"Ki/Ki","url":"https://www.bestkeptsecret.nl/program/ki-ki/51419"}],"secret":[{"start":"14:30","end":"15:15","name":"Katy Kirby","url":"https://www.bestkeptsecret.nl/program/katy-kirby/49802"},{"start":"16:00","end":"16:45","name":"English Teacher","url":"https://www.bestkeptsecret.nl/program/english-teacher/49779"},{"start":"17:30","end":"18:15","name":"Mannequin Pussy","url":"https://www.bestkeptsecret.nl/program/mannequin-pussy/49811"},{"start":"19:00","end":"19:45","name":"Sofia Kourtesis (live)","url":"https://www.bestkeptsecret.nl/program/sofia-kourtesis/51436"},{"start":"20:30","end":"21:30","name":"Minyo Crusaders","url":"https://www.bestkeptsecret.nl/program/minyo-crusaders/49820"},{"start":"22:15","end":"23:15","name":"Baxter Dury","url":"https://www.bestkeptsecret.nl/program/baxter-dury/49932"},{"start":"00:00","end":"01:00","name":"The Armed","url":"https://www.bestkeptsecret.nl/program/the-armed/49851"},{"start":"01:30","end":"04:00","name":"Iconic (Queer Pop)","url":"https://www.bestkeptsecret.nl/program/iconic-queer-pop/60716"}],"floor":[{"start":"16:30","end":"17:30","name":"Joost Oomen (DJ set & action poetry)","url":"https://www.bestkeptsecret.nl/program/joost-oomen-dj-set-action-poetry/60448"},{"start":"18:30","end":"19:30","name":"Cami Layé Okún","url":"https://www.bestkeptsecret.nl/program/cami-laye-okun/60256"},{"start":"20:00","end":"21:00","name":"St. Paul & the Broken Bones B2B St. Paul","url":"https://www.bestkeptsecret.nl/program/st-paul-the-broken-bones-b2b-st-paul/60259"},{"start":"21:00","end":"22:00","name":"Sammy Virji","url":"https://www.bestkeptsecret.nl/program/sammy-virji/60262"},{"start":"22:30","end":"23:30","name":"Left of the Dial (DJ set)","url":"https://www.bestkeptsecret.nl/program/left-of-the-dial-dj-set/60265"},{"start":"00:00","end":"01:00","name":"Shug La Sheedah (history of hip hop)","url":"https://www.bestkeptsecret.nl/program/shug-la-sheedah-history-of-hip-hop/50203"},{"start":"01:30","end":"02:30","name":"Nadiem Shah","url":"https://www.bestkeptsecret.nl/program/nadiem-shah/50219"}],"casbah":[{"start":"15:15","end":"16:00","name":"Texoprint","url":"https://www.bestkeptsecret.nl/program/kalaallit-nunaat/49869"},{"start":"17:30","end":"18:15","name":"Chastity Belt","url":"https://www.bestkeptsecret.nl/program/chastity-belt/49929"},{"start":"19:30","end":"20:15","name":"Upchuck","url":"https://www.bestkeptsecret.nl/program/upchuck/51460"},{"start":"21:30","end":"22:15","name":"Vals Alarm","url":"https://www.bestkeptsecret.nl/program/vals-alarm/60186"},{"start":"23:30","end":"00:15","name":"Snõõper","url":"https://www.bestkeptsecret.nl/program/snooper/49841"},{"start":"00:15","end":"04:00","name":"Here's the Thing DJ's"}],"coney-island":[{"start":"16:00","end":"18:00","name":"DJ Tracksuit","url":"https://www.bestkeptsecret.nl/program/dj-tracksuit/50225"},{"start":"18:00","end":"20:00","name":"Joiah","url":"https://www.bestkeptsecret.nl/program/joiah/50709"},{"start":"20:00","end":"22:00","name":"Sennes","url":"https://www.bestkeptsecret.nl/program/sennes/60239"},{"start":"22:00","end":"00:00","name":"Berkan V8","url":"https://www.bestkeptsecret.nl/program/berkan-v8/50713"},{"start":"00:00","end":"02:00","name":"Black Rave Culture","url":"https://www.bestkeptsecret.nl/program/black-rave-culture/51395"},{"start":"02:00","end":"04:00","name":"Cashu","url":"https://www.bestkeptsecret.nl/program/cashu/51402"}],"muziekgieterij":[{"start":"15:00","end":"16:00","name":"Upchuck","url":"https://www.bestkeptsecret.nl/program/upchuck/51460"},{"start":"17:15","end":"18:15","name":"Katy Kirby","url":"https://www.bestkeptsecret.nl/program/katy-kirby/49802"},{"start":"19:30","end":"20:15","name":"Ise","url":"https://www.bestkeptsecret.nl/program/ise/60642"},{"start":"21:45","end":"22:30","name":"Droom Dit","url":"https://www.bestkeptsecret.nl/program/droom-dit/51471"}]}},{"id":"saturday","name":"Saturday","date":"2024-06-08","events":{"one":[{"start":"16:00","end":"17:00","name":"Merol","url":"https://www.bestkeptsecret.nl/program/merol/60190"},{"start":"18:00","end":"19:00","name":"Fatoumata Diawara","url":"https://www.bestkeptsecret.nl/program/fatoumata-diawara/49789"},{"start":"20:00","end":"21:00","name":"Parcels","url":"https://www.bestkeptsecret.nl/program/parcels/49828"},{"start":"22:00","end":"00:00","name":"Paolo Nutini","url":"https://www.bestkeptsecret.nl/program/paolo-nutini/51425"}],"two":[{"start":"12:00","end":"12:45","name":"The Amazons","url":"https://www.bestkeptsecret.nl/program/the-amazons/51447"},{"start":"13:30","end":"14:15","name":"CMAT","url":"https://www.bestkeptsecret.nl/program/cmat/60206"},{"start":"15:00","end":"16:00","name":"Royel Otis","url":"https://www.bestkeptsecret.nl/program/royel-otis/51431"},{"start":"17:00","end":"18:00","name":"Tramhaus","url":"https://www.bestkeptsecret.nl/program/tramhaus/49857"},{"start":"19:00","end":"20:00","name":"Vince Staples","url":"https://www.bestkeptsecret.nl/program/vince-staples/51463"},{"start":"21:00","end":"22:10","name":"Slowdive","url":"https://www.bestkeptsecret.nl/program/slowdive/49838"},{"start":"00:00","end":"01:00","name":"Altin Gün","url":"https://www.bestkeptsecret.nl/program/altin-gun/51386"}],"secret":[{"start":"12:15","end":"13:00","name":"Ratboys","url":"https://www.bestkeptsecret.nl/program/ratboys/51428"},{"start":"13:30","end":"14:15","name":"Grace Cummings","url":"https://www.bestkeptsecret.nl/program/grace-cummings/51411"},{"start":"15:00","end":"15:45","name":"Etran de L'Aïr","url":"https://www.bestkeptsecret.nl/program/etran-de-lair/49782"},{"start":"16:30","end":"17:15","name":"Infinity Song","url":"https://www.bestkeptsecret.nl/program/infinity-song/60209"},{"start":"18:00","end":"18:45","name":"Mildlife","url":"https://www.bestkeptsecret.nl/program/mildlife/49814"},{"start":"19:30","end":"20:15","name":"The Mary Wallopers","url":"https://www.bestkeptsecret.nl/program/the-mary-wallopers/51449"},{"start":"21:00","end":"21:45","name":"Mula B","url":"https://www.bestkeptsecret.nl/program/mula-b-band/49934"},{"start":"22:30","end":"23:15","name":"Lambrini Girls","url":"https://www.bestkeptsecret.nl/program/lambrini-girls/60203"},{"start":"00:00","end":"01:00","name":"Osees","url":"https://www.bestkeptsecret.nl/program/osees/49822"},{"start":"01:30","end":"04:00","name":"Tjade","url":"https://www.bestkeptsecret.nl/program/tjade/51457"}],"floor":[{"start":"13:00","end":"14:00","name":"Ararat Taxi Service","url":"https://www.bestkeptsecret.nl/program/ararat-taxi-service/60267"},{"start":"15:00","end":"16:00","name":"Roxeanne Hazes (DJ set)","url":"https://www.bestkeptsecret.nl/program/roxeanne-hazes-dj-set/60270"},{"start":"17:00","end":"18:00","name":"Julie Pavon (live)","url":"https://www.bestkeptsecret.nl/program/julie-pavon-live/60480"},{"start":"19:30","end":"20:30","name":"Joes Brauers (Dutch Masters DJ set)","url":"https://www.bestkeptsecret.nl/program/joes-brauers-dutch-masters-dj-set/60275"},{"start":"21:00","end":"22:00","name":"Malou","url":"https://www.bestkeptsecret.nl/program/malou/60280"},{"start":"23:00","end":"00:00","name":"Chewchew","url":"https://www.bestkeptsecret.nl/program/chew-chew/50200"},{"start":"00:30","end":"01:30","name":"Coco Bryce","url":"https://www.bestkeptsecret.nl/program/coco-bryce/60277"},{"start":"02:00","end":"03:00","name":"Perfect Indie Disco: St. Paul B2B Vera Siemons","url":"https://www.bestkeptsecret.nl/program/perfect-indie-disco-st-paul-b2b-vera-siemons/60283"}],"casbah":[{"start":"14:00","end":"14:45","name":"Winter","url":"https://www.bestkeptsecret.nl/program/winter/71343"},{"start":"16:00","end":"16:45","name":"Cherry Glazerr","url":"https://www.bestkeptsecret.nl/program/cherry-glazerr/51475"},{"start":"18:00","end":"18:45","name":"Yhwh Nailgun","url":"https://www.bestkeptsecret.nl/program/yhwh-nailgun/49936"},{"start":"20:00","end":"20:45","name":"Library Card","url":"https://www.bestkeptsecret.nl/program/library-card/49877"},{"start":"22:00","end":"22:45","name":"Faux Real","url":"https://www.bestkeptsecret.nl/program/faux-real/51408"},{"start":"00:00","end":"00:45","name":"Deijuvhs","url":"https://www.bestkeptsecret.nl/program/deijuvhs/51405"},{"start":"00:45","end":"04:00","name":"Loose Ends DJ's","url":"https://www.bestkeptsecret.nl/program/loose-ends-djs/70331"}],"coney-island":[{"start":"16:00","end":"18:00","name":"Loradeniz","url":"https://www.bestkeptsecret.nl/program/loradeniz/60233"},{"start":"18:00","end":"20:00","name":"Askmelater","url":"https://www.bestkeptsecret.nl/program/askmelater/50725"},{"start":"20:00","end":"22:00","name":"Lenxi (hybrid live)","url":"https://www.bestkeptsecret.nl/program/lenxi-hybrid-live/60228"},{"start":"22:00","end":"00:00","name":"Passion Deez","url":"https://www.bestkeptsecret.nl/program/passion-deez/50729"},{"start":"00:00","end":"02:00","name":"Blck Mamba","url":"https://www.bestkeptsecret.nl/program/blck-mamba/51399"},{"start":"02:00","end":"04:00","name":"Bambii","url":"https://www.bestkeptsecret.nl/program/bambii/51389"}],"muziekgieterij":[{"start":"13:00","end":"14:00","name":"Library Card","url":"https://www.bestkeptsecret.nl/program/library-card/49877"},{"start":"15:00","end":"16:00","name":"Faux Real","url":"https://www.bestkeptsecret.nl/program/faux-real/51408"},{"start":"17:00","end":"18:00","name":"Session 3 (TBA)"},{"start":"19:15","end":"20:00","name":"Lézard","url":"https://www.bestkeptsecret.nl/program/lezard/60249"},{"start":"21:30","end":"22:15","name":"Porcelain ID","url":"https://www.bestkeptsecret.nl/program/porcelain-id/51478"}]}},{"id":"sunday","name":"Sunday","date":"2024-06-09","events":{"one":[{"start":"15:30","end":"16:30","name":"Warhaus","url":"https://www.bestkeptsecret.nl/program/warhaus/49860"},{"start":"17:30","end":"18:30","name":"De Jeugd van Tegenwoordig","url":"https://www.bestkeptsecret.nl/program/de-jeugd-van-tegenwoordig/49767"},{"start":"19:30","end":"20:30","name":"Tamino","url":"https://www.bestkeptsecret.nl/program/tamino/49848"},{"start":"22:00","end":"23:15","name":"Justice","url":"https://www.bestkeptsecret.nl/program/justice/49799"}],"two":[{"start":"12:00","end":"12:45","name":"Pip Blom","url":"https://www.bestkeptsecret.nl/program/pip-blom/71337"},{"start":"13:15","end":"14:00","name":"The Indien","url":"https://www.bestkeptsecret.nl/program/the-indien/50826"},{"start":"14:45","end":"15:30","name":"Jockstrap","url":"https://www.bestkeptsecret.nl/program/jockstrap/51416"},{"start":"16:30","end":"17:30","name":"The Haunted Youth","url":"https://www.bestkeptsecret.nl/program/the-haunted-youth/50822"},{"start":"18:30","end":"19:30","name":"Amyl & the Sniffers","url":"https://www.bestkeptsecret.nl/program/amyl-the-sniffers/49759"},{"start":"20:30","end":"21:45","name":"PJ Harvey","url":"https://www.bestkeptsecret.nl/program/pj-harvey/49832"},{"start":"23:15","end":"00:15","name":"Floating Points","url":"https://www.bestkeptsecret.nl/program/floating-points/49791"}],"secret":[{"start":"12:00","end":"12:45","name":"Thandii","url":"https://www.bestkeptsecret.nl/program/thandii/60221"},{"start":"13:15","end":"14:00","name":"néomí","url":"https://www.bestkeptsecret.nl/program/neomi/60252"},{"start":"14:30","end":"15:15","name":"Water from Your Eyes","url":"https://www.bestkeptsecret.nl/program/water-from-your-eyes/49866"},{"start":"16:00","end":"16:45","name":"The Mysterines","url":"https://www.bestkeptsecret.nl/program/the-mysterines/49863"},{"start":"17:30","end":"18:15","name":"Slow Pulp","url":"https://www.bestkeptsecret.nl/program/slow-pulp/49835"},{"start":"19:00","end":"19:45","name":"Paris Paloma","url":"https://www.bestkeptsecret.nl/program/paris-paloma/60196"},{"start":"20:30","end":"21:15","name":"Dorian Electra","url":"https://www.bestkeptsecret.nl/program/dorian-electra/49775"},{"start":"22:00","end":"23:00","name":"Billy Woods","url":"https://www.bestkeptsecret.nl/program/billy-woods/51392"},{"start":"23:45","end":"00:30","name":"Coloray","url":"https://www.bestkeptsecret.nl/program/coloray/60647"}],"floor":[{"start":"13:00","end":"14:00","name":"Library Card (DJ set)","url":"https://www.bestkeptsecret.nl/program/library-card-dj-set/50216"},{"start":"15:00","end":"16:00","name":"Dokter Moon B2B Dochter Moon","url":"https://www.bestkeptsecret.nl/program/dokter-moon-b2b-dochter-moon/50206"},{"start":"16:30","end":"17:30","name":"Unruly Phoenix (3 step set)","url":"https://www.bestkeptsecret.nl/program/unruly-phoenix-3-step-set/50213"},{"start":"18:00","end":"19:00","name":"Hauptgast","url":"https://www.bestkeptsecret.nl/program/hauptgast/50193"},{"start":"19:30","end":"20:30","name":"Phillipi (Deewee)","url":"https://www.bestkeptsecret.nl/program/phillipi-deewee/50209"},{"start":"21:00","end":"22:00","name":"The Glimmers","url":"https://www.bestkeptsecret.nl/program/the-glimmers/50196"},{"start":"22:30","end":"23:30","name":"Pelanoir","url":"https://www.bestkeptsecret.nl/program/pelanoir/60285"}],"casbah":[{"start":"14:00","end":"14:45","name":"Ada Oda","url":"https://www.bestkeptsecret.nl/program/ada-oda/60215"},{"start":"16:00","end":"16:45","name":"Hiqpy","url":"https://www.bestkeptsecret.nl/program/hiqpy/60193"},{"start":"18:00","end":"18:45","name":"Ali","url":"https://www.bestkeptsecret.nl/program/ali/60212"},{"start":"20:00","end":"20:45","name":"Gurriers","url":"https://www.bestkeptsecret.nl/program/gurriers/60200"},{"start":"22:00","end":"22:45","name":"Sprints","url":"https://www.bestkeptsecret.nl/program/sprints/51440"}],"coney-island":[{"start":"16:00","end":"18:00","name":"Lola Edo","url":"https://www.bestkeptsecret.nl/program/lola-edo/50717"},{"start":"18:00","end":"20:00","name":"Teqmun","url":"https://www.bestkeptsecret.nl/program/teqmun/60241"},{"start":"20:00","end":"22:00","name":"Naone","url":"https://www.bestkeptsecret.nl/program/naone/60236"},{"start":"22:00","end":"00:00","name":"French II","url":"https://www.bestkeptsecret.nl/program/french-ii/50721"}],"muziekgieterij":[{"start":"12:30","end":"13:30","name":"Session 1 (TBA)"},{"start":"14:30","end":"15:30","name":"Ali","url":"https://www.bestkeptsecret.nl/program/ali/60212"},{"start":"16:30","end":"17:30","name":"Gurriers","url":"https://www.bestkeptsecret.nl/program/gurriers/60200"},{"start":"18:30","end":"19:15","name":"Affaire","url":"https://www.bestkeptsecret.nl/program/affaire/60244"},{"start":"21:15","end":"22:00","name":"Parker Fans","url":"https://www.bestkeptsecret.nl/program/parker-fans/72213"}]}}]`),v={config:f,stages:y,schedule:S};class w{constructor(e,t,s,r){o(this,"svg");o(this,"rangeInCoords");o(this,"currentTimeLine");o(this,"blockHeight");this.svg=e,this.currentTimeLine=t,this.blockHeight=s,this.rangeInCoords=r,this.updateCurrentTimeLine()}clip(e,t){const s=t-e,r=this.blockHeight.coords,n=s/this.blockHeight.coords*this.blockHeight.pixels,a=this.blockHeight.pixels;this.svg.setAttribute("viewBox",`${e} 0 ${s} ${r}`),this.svg.setAttribute("width",n.toString()),this.svg.setAttribute("height",a.toString())}updateCurrentTimeLine(){const e=new Date,t=w.toSvgCoordinates(this.currentTimeLine.referenceTime,e),s=this.currentTimeLine.element;s.setAttribute("x1",t.toString()),s.setAttribute("x2",t.toString())}getCurrentTimeLineElement(){return this.currentTimeLine.element}static fromSchedule(e,t,s){return new c(e,t,s).buildStageSchedule()}static toSvgCoordinates(e,t){return(t.getTime()-e.getTime())/(1e3*60)}static getHourCoordinates(){return{start:0,end:48*60,step:60}}}class c{constructor(e,t,s){o(this,"dayId");o(this,"stageId");o(this,"schedule");o(this,"stageColour");o(this,"referenceTime");this.dayId=t,this.stageId=s,this.schedule=e,this.stageColour=e.getStage(s).colour,this.referenceTime=e.getReferenceTime(t)}buildStageSchedule(){const e=c.createSvgElement("svg"),t=this.createHourLines(),[s,r]=this.createCurrentTimeLine(),[n,a]=this.createBlocks();e.appendChild(t),e.appendChild(n),e.appendChild(s),e.appendChild(a);const l=this.schedule.getRangeForStage(this.dayId,this.stageId).map(p=>w.toSvgCoordinates(this.referenceTime,p));return new w(e,r,{...this.schedule.getConfig().blockHeight},l)}createHourLines(){const e=this.schedule.getConfig(),t=c.createSvgElement("g"),s=w.getHourCoordinates();for(let r=s.start;r<s.end;r+=s.step){const n=c.createSvgElement("line",{x1:r.toString(),y1:"0",x2:r.toString(),y2:e.blockHeight.coords.toString()});n.classList.add("hour"),t.appendChild(n)}return t}createCurrentTimeLine(){const e=this.schedule.getConfig(),t=c.createSvgElement("g"),s=c.createSvgElement("line",{x1:"0",y1:"0",x2:"0",y2:e.blockHeight.coords.toString()});s.classList.add("current-time"),t.appendChild(s);const r={referenceTime:this.referenceTime,element:s};return[t,r]}createBlocks(){const e=c.createSvgElement("g"),t=c.createSvgElement("g"),s=this.schedule.getEvents(this.dayId,this.stageId);for(const r of s){const[n,a]=this.schedule.getEventRange(this.dayId,r),i=w.toSvgCoordinates(this.referenceTime,n),p=w.toSvgCoordinates(this.referenceTime,a)-i,m=this.createBlock(i,p,r),g=this.createBlockText(i,p,r);e.appendChild(m),t.appendChild(g)}return[e,t]}createBlock(e,t,s){const r=this.schedule.getConfig(),n=c.createSvgElement("rect",{x:e.toString(),y:"0",width:t.toString(),height:r.blockHeight.coords.toString(),fill:this.stageColour});return n.classList.add("block"),s.url&&(n.classList.add("clickable"),n.addEventListener("click",()=>window.open(s.url,"_blank"))),n}createBlockText(e,t,s){const r=this.schedule.getConfig(),n=c.createSvgElement("foreignObject",{x:e.toString(),y:"0",width:t.toString(),height:r.blockHeight.coords.toString()});n.classList.add("block-text");const a=c.createXhtmlElement("div");a.classList.add("text-container");const i=c.createXhtmlElement("div");i.classList.add("artist-name"),i.textContent=s.name;const l=c.createXhtmlElement("div");return l.classList.add("time"),l.textContent=`${s.start} – ${s.end}`,a.appendChild(i),a.appendChild(l),n.appendChild(a),n}static createElement(e,t,s){const r=document.createElementNS(t,e);if(s)for(const[n,a]of Object.entries(s))r.setAttribute(n,a);return r}static createSvgElement(e,t){return c.createElement(e,"http://www.w3.org/2000/svg",t)}static createXhtmlElement(e,t){return c.createElement(e,"http://www.w3.org/1999/xhtml",t)}}class u{constructor(e,t,s,r){o(this,"container");o(this,"stageSchedules");this.container=e,this.stageSchedules=u.generateStageSchedules(t),this.updateBlockSchedule(s,r)}updateBlockSchedule(e,t){const[s,r]=this.computeCurrentRangeInCoords(e,t);this.clearContainer(),this.mapCurrentStages(e,t,n=>{n.clip(s,r),this.container.appendChild(n.svg)})}updateCurrentTimeLines(e,t){this.mapCurrentStages(e,t,s=>s.updateCurrentTimeLine())}getCurrentTimeLineElement(e,t){return this.mapCurrentStages(e,t,r=>r.getCurrentTimeLineElement())[0]??null}clearContainer(){const e=this.container;for(;e.lastChild;)e.removeChild(e.lastChild)}computeCurrentRangeInCoords(e,t){const s=this.mapCurrentStages(e,t,a=>a.rangeInCoords),r=Math.min(...s.map(a=>a[0])),n=Math.max(...s.map(a=>a[1]));return[r,n]}mapCurrentStages(e,t,s){const r=this.stageSchedules.get(e);if(!r)throw new Error(`No day with ID "${e}" exists.`);return Array.from(r.keys()).filter(a=>t.includes(a)).map(a=>{const i=r.get(a);if(!i)throw new Error(`No schedule for stage with ID "${a}" exists for day with ID "${e}".`);return s(i)})}static generateStageSchedules(e){const t=new Map;for(const s of e.getDayIds()){const r=new Map;t.set(s,r);for(const n of e.getStageIds(s))r.set(n,w.fromSchedule(e,s,n))}return t}}class C{constructor(e,t,s,r,n){o(this,"daysContainer");o(this,"stagesContainer");o(this,"eventsContainer");o(this,"nowButton");o(this,"dayElements");o(this,"stageElements");o(this,"schedule");o(this,"blockSchedule");o(this,"dayId");o(this,"enabledStageIds");o(this,"dayIdCurrentTime");o(this,"scrollPosition");this.daysContainer=e,this.stagesContainer=t,this.eventsContainer=s,this.nowButton=r,this.schedule=n;const a=n.getDayIds()[0];if(!a)throw new Error("Cannot render schedule without days.");this.dayId=a,this.enabledStageIds=n.getStageIds(),this.dayIdCurrentTime=null,this.scrollPosition=null,this.loadState(),this.dayElements=new Map,this.stageElements=new Map,this.populateDays(),this.populateStages(),this.blockSchedule=new u(this.eventsContainer,n,this.dayId,this.enabledStageIds),this.restoreScrollPosition(),this.setDayId(this.dayId),s.addEventListener("scrollend",()=>{this.saveScrollPosition()});const i=(l,p)=>{const m=document.documentElement;m.scrollHeight>m.clientHeight||(p.preventDefault(),l.scrollLeft+=p.deltaY)};this.daysContainer.addEventListener("wheel",l=>i(this.daysContainer,l)),this.stagesContainer.addEventListener("wheel",l=>i(this.stagesContainer,l)),this.eventsContainer.addEventListener("wheel",l=>i(this.eventsContainer,l)),this.nowButton.addEventListener("click",()=>{if(!this.dayIdCurrentTime)return;this.setDayId(this.dayIdCurrentTime);const l=this.blockSchedule.getCurrentTimeLineElement(this.dayId,this.enabledStageIds);l&&l.scrollIntoView({behavior:"smooth",inline:"center"})}),window.setInterval(()=>this.updateForCurrentTime(),30*1e3),this.updateForCurrentTime(),window.addEventListener("focus",()=>{this.updateForCurrentTime()})}saveState(){localStorage.setItem("dayId",this.dayId),localStorage.setItem("enabledStageIds",JSON.stringify(this.enabledStageIds)),this.scrollPosition!==null&&localStorage.setItem("scrollPosition",this.scrollPosition.toString())}loadState(){const e=localStorage.getItem("dayId");e&&(this.dayId=e);const t=localStorage.getItem("enabledStageIds");t&&(this.enabledStageIds=JSON.parse(t));const s=localStorage.getItem("scrollPosition");s&&(this.scrollPosition=parseFloat(s))}populateDays(){for(const e of this.schedule.getDays()){const t=document.createElement("div");t.classList.add("day");const s=e.id===this.dayId;t.classList.add(s?"active":"inactive"),t.textContent=e.name,t.addEventListener("click",()=>this.setDayId(e.id)),this.dayElements.set(e.id,t),this.daysContainer.appendChild(t)}}populateStages(){for(const e of this.schedule.getStages()){const t=document.createElement("div");t.classList.add("stage"),t.style.backgroundColor=e.colour,t.addEventListener("click",()=>this.toggleStageId(e.id));const s=document.createElement("div");s.textContent=e.name,t.appendChild(s),this.stageElements.set(e.id,t),this.stagesContainer.appendChild(t)}}restoreScrollPosition(){this.scrollPosition!==null&&(this.eventsContainer.scrollLeft=this.scrollPosition)}updateStages(){for(const e of this.schedule.getStages()){const t=this.stageElements.get(e.id);if(!t)throw new Error(`No container was created for stage with ID "${e.id}."`);if(this.schedule.hasStage(this.dayId,e.id))t.classList.remove("unavailable");else{t.classList.add("unavailable");continue}const s=this.enabledStageIds.includes(e.id);t.classList.add(s?"active":"inactive")}}updateForCurrentTime(){this.updateCurrentTimeLines();const e=new Date;this.dayIdCurrentTime=this.schedule.getDayIdForDateTime(e,this.enabledStageIds),this.dayIdCurrentTime?this.nowButton.classList.remove("unavailable"):this.nowButton.classList.add("unavailable")}updateCurrentTimeLines(){this.blockSchedule.updateCurrentTimeLines(this.dayId,this.enabledStageIds)}setDayId(e){this.dayId=e;for(const[t,s]of this.dayElements)s.classList.remove("active","inactive"),s.classList.add(t===e?"active":"inactive");this.updateStages(),this.blockSchedule.updateBlockSchedule(this.dayId,this.enabledStageIds),this.updateCurrentTimeLines(),this.saveState()}toggleStageId(e){const t=this.stageElements.get(e);if(!t)throw new Error(`No container was created for stage with ID "${e}."`);!this.enabledStageIds.includes(e)?(this.enabledStageIds.push(e),t.classList.remove("inactive"),t.classList.add("active")):(this.enabledStageIds=this.enabledStageIds.filter(r=>r!==e),t.classList.remove("active"),t.classList.add("inactive")),this.blockSchedule.updateBlockSchedule(this.dayId,this.enabledStageIds),this.saveState()}saveScrollPosition(){this.scrollPosition=this.eventsContainer.scrollLeft,this.saveState()}}class h{constructor(e){o(this,"config");o(this,"stages");o(this,"schedule");o(this,"scheduleRanges");this.config=e.config,this.stages=e.stages,this.schedule=e.schedule,this.scheduleRanges=this.computeScheduleRanges()}getConfig(){return this.config}getDayIds(){return this.schedule.map(e=>e.id)}getStageIds(e){if(e===void 0)return this.stages.map(t=>t.id);{const t=this.getDay(e);return Object.keys(t.events)}}hasStage(e,t){return this.getStageIds(e).includes(t)}getDays(){return this.schedule}getStages(e){if(e===void 0)return this.stages;{const t=this.getStageIds(e);return this.stages.filter(s=>t.includes(s.id))}}getDay(e){const t=this.schedule.find(s=>s.id===e);if(!t)throw new Error(`No day with ID "${e}" exists.`);return t}getStage(e){const t=this.stages.find(s=>s.id===e);if(!t)throw new Error(`No stage with ID "${e}" exists.`);return t}getEvents(e,t){const r=this.getDay(e).events[t];if(r===void 0)throw new Error(`No events for stage with ID "${t}" exist on day with ID "${e}".`);return r}getEventRange(e,t){const s=this.getDay(e).date,r=h.parseDateTime(s,t.start),n=h.parseDateTime(s,t.end);return[r,n]}getRangeForStage(e,t){const s=this.scheduleRanges.get(e);if(!s)throw new Error(`No day with ID "${e}" exists.`);const r=s.get(t);if(!r)throw new Error(`No stage with ID "${t}" exists.`);return r}getRange(e,t){const r=t.filter(i=>this.hasStage(e,i)).map(i=>this.getRangeForStage(e,i)),n=new Date(Math.min(...r.map(i=>i[0].getTime()))),a=new Date(Math.max(...r.map(i=>i[1].getTime())));return[n,a]}getDayIdForDateTime(e,t){for(const s of this.getDayIds()){const[r,n]=this.getRange(s,t);if(e>=r&&e<=n)return s}return null}getReferenceTime(e){return h.parseDate(this.getDay(e).date)}static async fetch(e){const s=await(await fetch(e)).json();return new h(s)}computeScheduleRanges(){const e=new Map;for(const t of this.getDays()){e.set(t.id,new Map);const s=e.get(t.id);for(const r of this.getStageIds(t.id)){const n=this.getEvents(t.id,r),a=n.map(m=>h.parseDateTime(t.date,m.start).getTime()),i=n.map(m=>h.parseDateTime(t.date,m.end).getTime()),l=new Date(Math.min(...a)),p=new Date(Math.max(...i));s.set(r,[l,p])}}return e}static parseDateTime(e,t){const s=h.parseDate(e),r=t.split(":").map(l=>parseInt(l));let n=r[0];const a=r[1];if(n===void 0||a===void 0)throw new Error(`Failed to parse time "${t}".`);n<6&&(n+=24);const i=(n*60+a)*60*1e3;return new Date(s.getTime()+i)}static parseDate(e){const t=new Date(e);return t.setHours(0,0,0,0),t}}function I(){const d=new h(v),e=document.querySelector("#days"),t=document.querySelector("#stages"),s=document.querySelector("#events"),r=document.querySelector("#now-button");new C(e,t,s,r,d)}I();
